<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Auto-Fahr-Szene</title>
    <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
  </head>
  <body>
    <a-scene xr-mode-ui="enabled: false" background="color: #000000">

      <!-- Kamera (Vogelperspektive) -->
      <a-entity camera look-controls wasd-controls position="0 10 10" rotation="-45 0 0"></a-entity>

      <!-- Große weiße Ebene -->
      <a-plane width="20" height="20" color="#FFFFFF" rotation="-90 0 0"></a-plane>

      <!-- Kleine schwarze Ebene in der Mitte -->
      <a-plane width="10" height="10" color="#000000" rotation="-90 0 0"></a-plane>

      <!-- Auto-Modell -->
      <a-entity id="car" gltf-model="url(models/bmw-326/scene.gltf)" scale="0.01 0.01 0.01" position="0 0.05 0" rotation="0 0 0" car-controls></a-entity>

      <!-- Controller (links) -->
      <a-entity id="leftController" oculus-touch-controls="hand: left"></a-entity>

      <!-- Komponente für die Auto-Steuerung -->
      <script>
          AFRAME.registerComponent('car-controls', {
              tick: function() {
                  let car = this.el;
                  let leftController = document.getElementById('leftController');
                  let joystick = leftController.components['oculus-touch-controls'] ? leftController.components['oculus-touch-controls'].thumbstick : {x: 0, y:0}; // Handle null-werte

                  if (joystick && (joystick.x !== 0 || joystick.y !== 0)) {
                    let forward = new THREE.Vector3(0, 0, -1);
                    forward.applyQuaternion(car.object3D.quaternion);
                    let moveSpeed = 0.05;
                    
                    let movement = new THREE.Vector3(0,0,0);
                    movement.copy(forward).multiplyScalar(joystick.y * moveSpeed);

                    car.object3D.position.add(movement);
                  }
              }
          });
      </script>
    </a-scene>
  </body>
</html>